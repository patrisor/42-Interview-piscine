O(n) with n the pixels
O(1) space to tmp
